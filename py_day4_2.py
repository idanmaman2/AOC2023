import functools,operator,itertools
print(sum(functools.reduce(lambda x,y:x|dict(((y[0],sum(x[z]for z in y[1])+1),)),reversed({i:range(i+1,i+j+1)for i,j in enumerate(map(lambda x:len(operator.and_(*(set(y.split())for y in x.split("|")))),open("./inps/input_day4.txt",'r').readlines()),1)}.items()),{}).values()))